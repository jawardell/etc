<!DOCTYPE html>
<html>
<!--
   This web page shows how to do a simple animation using 2D canvas graphics.
   It also defines functions applyWindowtoViewportTransformation, for setting
   up a coordinate system on the canvas, and addGraphicsContextExtras, for adding
   some extra drawing functions to a graphics context, such as functions for drawing
   lines and ovals.  Use this page as a basis for experimenting with animation.
-->
<head>
<meta charset="UTF-8">
<title>Snake</title>
<style>
    /* This style section is here to make the canvas more obvious on the
       page.  It is white on a light gray page background, with a thin
       black border. */
    body {
        background-color: #DDDDDD;
    }
    canvas {
        background-color: white;
        display: block;
    }
    #canvasholder {
        border:2px solid black;
        float: left; /* This makes the border exactly fit the canvas. */
    }
</style>
<script>


	var direction = 40;

	var x_coord = 100;
	var y_coord = 100;

    "use strict";  // gives improved error-checking in scripts.

    var canvas;    // The canvas element on which we will draw.
    var graphics;  // A 2D graphics context for drawing on the canvas.

    var elapsedTimeMillis;  // This will be the time since the animation started;
                            // will be zero in the first frame.

    var image;

	var drawFrame = false;
	
	var allLoaded;
	
	var frameNumber;

	var startTime;
	
	var grid;
	
	
    function draw() {
		frameNumber ++;
        //graphics.clearRect(0,0,canvas.width,canvas.height);  // Clear the canvas, so it shows its background color.
    } // end of draw()
    
    

    function doKeyDown(evt) {
        var code = evt.keyCode;  // Numerical code for key that was pressed.
		console.log("woo!! we did it key event!");
        switch (code) {
		case 37:  // left arrow key
			direction = 37;
		    break;
		case 39:  // right arrow key
			direction = 39;
		    break;
		case 38:  // up arrow key
			direction = 38;
		    break;
		case 40:  // down arrow key
			direction = 40;
		    break;
        }
    }
    
	
	

    /**
     *  Draw one frame of the animation, and call requestAnimationFrame() to arrange
     *  for the function to be called again.
     */
    function doFrame() {
		console.log("we are here");
		
		
		
		if(direction == 40) {
			y_coord += 20;
		}
		
		if(direction == 37) {
			x_coord -= 20;
		}
		
		if(direction == 39) {
			x_coord += 20;
		}
		
		if(direction == 38) {
			y_coord -= 20;
		}
		
		//graphics.clearRect(x_coord, y_coord-10,15,15);
		graphics.rect(x_coord, y_coord,15,15);
		graphics.stroke();
		
        frameNumber++;
        elapsedTimeMillis = Date.now() - startTime;
		
		if(elapsedTimeMillis > 15) {
			
			startTime = Date.now();
			draw();
			
			if(drawFrame) {
			
				//graphics.rect(x_coord*20, y_coord*20, 15, 15);
				//graphics.stroke();
				//x_coord += 10;
				//y_coord += 0;
				drawFrame = false;
				
			} else {
				draw();
				drawFrame = true;
			}
			
		
		} else {
			console.log("we ended up in else on line 139");
		}
		
		

		// GAME LOGIC here
		x_coord += 0;
		y_coord += 10;
		
		
	
        draw();

        requestAnimationFrame(doFrame);
    }
    

    function imageLoaded() {
		allLoaded = true;
    }



	// this function gets called when HTML page loads
	// canvas context gets initialized
	// one sample image is loaded
	// keyboard handler initialized
	// game loop is setup
    function init() {
        try {
            canvas = document.getElementById("canvas");
            graphics = canvas.getContext("2d");
		
			
			
        } catch(e) {
            document.getElementById("canvasholder").innerHTML =
               "Canvas graphics is not supported.<br>" +
               "An error occurred while initializing graphics."
	    		+ e.message;
	          }

		image = new Image(60, 45);   // using optional size for image
		// load an image of intrinsic size 300x227 in CSS pixels
		image.src = 'https://openclipart.org/image/2400px/svg_to_png/243661/1457652300.png';
		image.onload = imageLoaded();
		while(!allLoaded) { } // very risky 
		
		
		
		
		graphics.rect(100,100,15,15);
		graphics.stroke();
		

		// GAME INIT 

			var rows = canvas.height;
			var cols = canvas.width;
			grid = [];
			/*
			for(var i = 0; i < rows; i++) grid[i] = [];
			for(var i = 0; i < rows; i++) {
				for(var j = 0; j < cols; j++) {
					grid[i][j] = 0;
				}
			}  
			for(var i = 0; i < rows; i++) {
				for(var j = 0; j < cols; j++) {
					console.log(grid[i][j]);
				}
			}
			*/

		// handle keyboard
        document.addEventListener("keydown", doKeyDown, false);

        frameNumber = 0;
        elapsedTimeMillis = 0;
        startTime = Date.now();  // current time, in milliseconds.
        draw();  // Call draw() to draw on the canvas.
        if (!window.requestAnimationFrame) { // This is for Internet Explorer 9
            window.requestAnimationFrame = function(callback) {
                setTimeout(callback, 1000/60);    
            }
        }
        requestAnimationFrame(doFrame);
    }
    
</script>
</head>
<body onload="init()"> <!-- the onload attribute here is what calls the init() function -->

<h2>Snake</h2>
<p id='score'></p>
<noscript>
    <!-- This message will be shown in the page if JavaScript is not available. -->
<p>JavaScript is required to use this page.</p>
</noscript>

<div id="canvasholder">
<canvas id="canvas" width="800" height="600">
    <!-- This message is shown on the page if the browser doesn't support the canvas element. -->
Canvas not supported.
</canvas>
</div>

</body>
</html>
